<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Discrete Laplace mixture inference using the EM algorithm — disclapmix • disclapmix</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Discrete Laplace mixture inference using the EM algorithm — disclapmix"><meta property="og:description" content="disclapmix makes inference in a mixture of Discrete Laplace
distributions using the EM algorithm. After the EM algorithm has converged,
the centers are moved if the marginal likelihood increases by doing so. And
then the EM algorithm is run again. This continues until the centers are not
moved."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">disclapmix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.5.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/adaptive-fitting.html">Adaptive fitting</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/mixtures.html">Mixtures</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mikldk/disclapmix/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Discrete Laplace mixture inference using the EM algorithm</h1>
    <small class="dont-index">Source: <a href="https://github.com/mikldk/disclapmix/blob/HEAD/R/disclapmix.R" class="external-link"><code>R/disclapmix.R</code></a></small>
    <div class="hidden name"><code>disclapmix.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>disclapmix</code> makes inference in a mixture of Discrete Laplace
distributions using the EM algorithm. After the EM algorithm has converged,
the centers are moved if the marginal likelihood increases by doing so. And
then the EM algorithm is run again. This continues until the centers are not
moved.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">disclapmix</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">clusters</span>,</span>
<span>  init_y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  glm_method <span class="op">=</span> <span class="st">"internal_coef"</span>,</span>
<span>  glm_control_maxit <span class="op">=</span> <span class="fl">50L</span>,</span>
<span>  glm_control_eps <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  init_y_method <span class="op">=</span> <span class="st">"pam"</span>,</span>
<span>  init_v <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ret_x <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>Dataset.</p></dd>


<dt>clusters</dt>
<dd><p>The number of clusters/components to fit the model for.</p></dd>


<dt>init_y</dt>
<dd><p>Initial central haplotypes, if NULL, these will be estimated
as described under the <code>init_y_method</code> argument.</p></dd>


<dt>iterations</dt>
<dd><p>Maximum number of iterations in the EM-algorithm.</p></dd>


<dt>eps</dt>
<dd><p>Convergence stop criteria in the EM algorithm which is compared
to \(\frac{\max \{ v_{new} - v_{old} \}}{\max \{ v_{old} \}}\), where <code>v</code> is a matrix of each
observation's probability of belonging to a certain center.</p></dd>


<dt>verbose</dt>
<dd><p>from 0 to 2 (both including): 0 for silent, 2 for extra
verbose.</p></dd>


<dt>glm_method</dt>
<dd><p><code>internal_coef</code>, <code>internal_dev</code> or
<code>glm.fit</code>. Please see details.</p></dd>


<dt>glm_control_maxit</dt>
<dd><p>Integer giving the maximal number of IWLS
iterations.</p></dd>


<dt>glm_control_eps</dt>
<dd><p>Positive convergence tolerance epsilon; the
iterations converge when <code>|x - x_{old}|/(|x| + 0.1) &lt; epsilon</code>, where
<code>x = beta_correction</code> for <code>internal_coef</code> and <code>x = deviance</code>
otherwise.</p></dd>


<dt>init_y_method</dt>
<dd><p>Which cluster method to use for finding initial central
haplotypes, y: <code>pam</code> (recommended) or <code>clara</code>. Ignored if
<code>init_y</code> is supplied.</p></dd>


<dt>init_v</dt>
<dd><p>Matrix with `nrow(x)` rows and `clusters` columns specifying 
initial posterior probabilities to get EM started, if
none specified, then `matrix(1/clusters, nrow = nrow(x), ncol = clusters)` is used.</p></dd>


<dt>ret_x</dt>
<dd><p>Return data `x`</p></dd>


<dt>...</dt>
<dd><p>Used to detect obsolete usage (when using parameters
<code>centers</code>, <code>use.parallel</code>, <code>calculate.logLs</code> or
<code>plots.prefix</code>).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>disclapmixfit</code> object:</p><dl><dt>list("glm_method")</dt>
<dd><p>The supplied GLM method.</p></dd>

<dt>list("init_y")</dt>
<dd><p>The supplied initial central haplotypes,
<code>init_y</code>.</p></dd>
 
<dt>list("init_y_method")</dt>
<dd><p>The supplied method for
choosing initial central haplotypes (only used if <code>init_y</code> is
<code>NULL</code>).</p></dd>

<dt>list("converged")</dt>
<dd><p>Whether the estimation converged or not.</p></dd>

<dt>list("x")</dt>
<dd><p>Dataset used to fit the model if `ret_x` is `TRUE`, else `NULL`.</p></dd>
 
<dt>list("y")</dt>
<dd><p>The
central haplotypes, <code>y</code>.</p></dd>
 <dt>list("tau")</dt>
<dd><p>The prior probabilities of
belonging to a cluster, <code>tau</code>.</p></dd>
 <dt>list("v_matrix")</dt>
<dd><p>The matrix
<code>v</code> of each observation's probability of belonging to a certain
cluster. The rows are in the same order as the observations in <code>x</code> used
to generate this fit.</p></dd>
 <dt>list("disclap_parameters")</dt>
<dd><p>A matrix with the
estimated dicrete Laplace parameters.</p></dd>
 <dt>list("glm_coef")</dt>
<dd><p>The
coefficients from the last GLM fit (used to calculate
<code>disclap_parameters</code>).</p></dd>

<dt>list("model_observations")</dt>
<dd><p>Number of observations.</p></dd>

<dt>list("model_parameters")</dt>
<dd><p>Number of parameters in the model.</p></dd>

<dt>list("iterations")</dt>
<dd><p>Number of iterations performed in total (including
moving centers and re-estimating using the EM algorithm).</p></dd>

<dt>list("logL_full")</dt>
<dd><p>Full log likelihood of the final model.</p></dd>

<dt>list("logL_marginal")</dt>
<dd><p>Marginal log likelihood of the final model.</p></dd>

<dt>list("BIC_full")</dt>
<dd><p>BIC based on the full log likelihood of the final
model.</p></dd>
 
<dt>list("BIC_marginal")</dt>
<dd><p>BIC based on the marginal log likelihood
of the final model.</p></dd>

<dt>list("v_gain_iterations")</dt>
<dd><p>The gain \(\frac{\max \{ v_{new} -
v_{old} \}}{\max \{ v_{old} \}}\),
where <code>v</code> is <code>vic_matrix</code> mentioned above, during the iterations.</p></dd>

<dt>list("tau_iterations")</dt>
<dd><p>The prior probability of belonging to the
centers during the iterations.</p></dd>

<dt>list("logL_full_iterations")</dt>
<dd><p>Full log likelihood of the models during
the iterations (only calculated when <code>verbose = 2L</code>).</p></dd>

<dt>list("logL_marginal_iterations")</dt>
<dd><p>Marginal log likelihood of the
models during the iterations (only calculated when <code>verbose = 2L</code>).</p></dd>

<dt>list("BIC_full_iterations")</dt>
<dd><p>BIC based on full log likelihood of the
models during the iterations (only calculated when <code>verbose = 2L</code>).</p></dd>

<dt>list("BIC_marginal_iterations")</dt>
<dd><p>BIC based on marginal log likelihood
of the models during the iterations (only calculated when <code>verbose =
2L</code>).</p></dd>
 
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><code>glm_method</code>: <code>internal_coef</code> is the fastest as it uses the
relative changes in the coefficients as a stopping criterium, hence it does
not need to compute the deviance until the very end. In normal situations,
it would not be a problem to use this method. <code>internal_dev</code> is the
reasonably fast method that uses the deviance as a stopping criterium (like
<code>glm.fit</code>). <code>glm.fit</code> to use the traditional <code>glm.fit</code> IWLS
implementation and is slow compared to the other two methods.</p>
<p><code>init_y_method</code>: For <code>init_y_method = 'clara'</code>, the sampling
parameters are: <code>samples = 100</code>, <code>sampsize =
min(ceiling(nrow(x)/2), 100 + 2*clusters)</code> and the random number generator
in R is used.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="disclapmix-package.html">disclapmix-package</a></code> <code>disclapmix</code>
<code>disclapmixfit</code> <code><a href="predict.disclapmixfit.html">predict.disclapmixfit</a></code>
<code><a href="print.disclapmixfit.html">print.disclapmixfit</a></code> <code><a href="summary.disclapmixfit.html">summary.disclapmixfit</a></code>
<code><a href="simulate.disclapmixfit.html">simulate.disclapmixfit</a></code> <!-- %\code{\link{haplotype_diversity}} -->
<code><a href="clusterdist.html">clusterdist</a></code> <code><a href="clusterprob.html">clusterprob</a></code> <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm.fit</a></code>
<code><a href="https://rdrr.io/pkg/disclap/man/disclap-package.html" class="external-link">disclap</a></code> <code><a href="https://rdrr.io/pkg/cluster/man/pam.html" class="external-link">pam</a></code>
<code><a href="https://rdrr.io/pkg/cluster/man/clara.html" class="external-link">clara</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate sample database</span></span></span>
<span class="r-in"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu">disclap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/disclap/man/ddisclap.html" class="external-link">rdisclap</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">0.3</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">250</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add location parameters</span></span></span>
<span class="r-in"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">db</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">db</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="fl">13</span><span class="op">+</span><span class="va">i</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">db</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   15   15   16   19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   15   16   16   18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   13   16   16   18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   15   14   16   17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]   14   13   16   17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]   14   15   16   20</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">disclapmix</span><span class="op">(</span><span class="va">db</span>, clusters <span class="op">=</span> <span class="fl">1L</span>, verbose <span class="op">=</span> <span class="fl">1L</span>, glm_method <span class="op">=</span> <span class="st">"glm.fit"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Starting estimation for 1 clusters.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Estimating initial central haplotypes, y, using pam.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Initial central haplotypes, y, estimated.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Starting to generate model matrix.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Model matrix generated.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Starting to generate initial response vector.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Initial response vector done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Model matrix and initial vectors has been generated.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Starting the EM algorithm using glm.fit IRLS method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Iteration 1, max|vic - vic_old| / max(vic_old) = 0 / 0 = NaN (eps = 0.001)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Checking if the central haplotypes, y, are optimal.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Central haplotypes, y, were optimal, no need to more EM iterations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Done.</span>
<span class="r-in"><span><span class="va">fit1</span><span class="op">$</span><span class="va">disclap_parameters</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             locus1    locus2    locus3    locus4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cluster1 0.2987295 0.2895135 0.2987295 0.3062908</span>
<span class="r-in"><span><span class="va">fit1</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      locus1 locus2 locus3 locus4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     14     15     16     17</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit1b</span> <span class="op">&lt;-</span> <span class="fu">disclapmix</span><span class="op">(</span><span class="va">db</span>, clusters <span class="op">=</span> <span class="fl">1L</span>, verbose <span class="op">=</span> <span class="fl">1L</span>, glm_method <span class="op">=</span> <span class="st">"internal_coef"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Starting estimation for 1 clusters.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Estimating initial central haplotypes, y, using pam.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Initial central haplotypes, y, estimated.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: No need to generate model matrix when using internal_coef.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Starting to generate initial response vector.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Initial response vector done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Model matrix and initial vectors has been generated.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Starting the EM algorithm using internal_coef IRLS method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Iteration 1, max|vic - vic_old| / max(vic_old) = 0 / 0 = NaN (eps = 0.001)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Checking if the central haplotypes, y, are optimal.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Central haplotypes, y, were optimal, no need to more EM iterations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Done.</span>
<span class="r-in"><span><span class="va">fit1b</span><span class="op">$</span><span class="va">disclap_parameters</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             locus1    locus2    locus3    locus4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cluster1 0.2987295 0.2895135 0.2987295 0.3062908</span>
<span class="r-in"><span><span class="va">fit1b</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      locus1 locus2 locus3 locus4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     14     15     16     17</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">$</span><span class="va">disclap_parameters</span> <span class="op">-</span> <span class="va">fit1b</span><span class="op">$</span><span class="va">disclap_parameters</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.319878e-12</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate another type of database</span></span></span>
<span class="r-in"><span><span class="va">db2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu">disclap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/disclap/man/ddisclap.html" class="external-link">rdisclap</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">0.1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">500</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">db2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">db2</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">db2</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="fl">14</span><span class="op">+</span><span class="va">i</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">disclapmix</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">db</span>, <span class="va">db2</span><span class="op">)</span>, clusters <span class="op">=</span> <span class="fl">2L</span>, verbose <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Starting estimation for 2 clusters.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:05: Estimating initial central haplotypes, y, using pam.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: Initial central haplotypes, y, estimated.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: No need to generate model matrix when using internal_coef.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: Starting to generate initial response vector.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: Initial response vector done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: Model matrix and initial vectors has been generated.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: Starting the EM algorithm using internal_coef IRLS method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: Iteration 1, max|vic - vic_old| / max(vic_old) = 0.4994664 / 0 = Inf (eps = 0.001)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: Iteration 2, max|vic - vic_old| / max(vic_old) = 0.1829598 / 0.9994664 = 0.1830575 (eps = 0.001)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: Iteration 3, max|vic - vic_old| / max(vic_old) = 0.0614799 / 0.9999974 = 0.06148006 (eps = 0.001)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: Iteration 4, max|vic - vic_old| / max(vic_old) = 0.02246025 / 0.9999989 = 0.02246028 (eps = 0.001)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: Iteration 5, max|vic - vic_old| / max(vic_old) = 0.007478669 / 0.9999991 = 0.007478676 (eps = 0.001)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: Iteration 6, max|vic - vic_old| / max(vic_old) = 0.002454018 / 0.9999992 = 0.00245402 (eps = 0.001)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: Iteration 7, max|vic - vic_old| / max(vic_old) = 0.0008002148 / 0.9999992 = 0.0008002154 (eps = 0.001)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: Stopping after 7 iterations due to convergence, 0.001 &gt; 0.0008002154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: Checking if the central haplotypes, y, are optimal.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: Central haplotypes, y, were optimal, no need to more EM iterations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022-12-19 15:22:06: Done.</span>
<span class="r-in"><span><span class="va">fit2</span><span class="op">$</span><span class="va">disclap_parameters</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            locus1    locus2   locus3    locus4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cluster1 0.295931 0.2832260 0.294055 0.3023910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cluster2 0.104108 0.0996384 0.103448 0.1063806</span>
<span class="r-in"><span><span class="va">fit2</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      locus1 locus2 locus3 locus4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     14     15     16     17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     15     16     17     18</span>
<span class="r-in"><span><span class="va">fit2</span><span class="op">$</span><span class="va">tau</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3239832 0.6760168</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Mikkel Meyer Andersen, Poul Svante Eriksen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

